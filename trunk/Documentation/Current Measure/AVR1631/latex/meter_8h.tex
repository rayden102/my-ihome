\hypertarget{meter_8h}{\section{meter.\-h File Reference}
\label{meter_8h}\index{meter.\-h@{meter.\-h}}
}


Meter Calibration routine.  


{\ttfamily \#include $<$ioavr.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include \char`\"{}clksys\-\_\-driver.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}adc\-\_\-driver.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rtc\-\_\-driver.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}meter\-\_\-calculations.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}meter\-\_\-calibration.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}meter\-\_\-initialisation.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}meter\-\_\-lcd\-\_\-module.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}meter\-\_\-rtc.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}avr\-\_\-compiler.\-h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structcoefficient}{coefficient}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{meter_8h_ae28e0c2dae7677b14d2547e997bb2a63}{\#define {\bfseries R\-T\-C\-\_\-\-C\-Y\-C\-L\-E\-S\-\_\-1\-S}~1024}\label{meter_8h_ae28e0c2dae7677b14d2547e997bb2a63}

\item 
\hypertarget{meter_8h_a0db728a697b0c3fe6a12ec0f01c56320}{\#define {\bfseries T\-A\-M\-P\-E\-R\-\_\-\-C\-U\-R\-R\-E\-N\-T\-\_\-\-R\-E\-V\-E\-R\-S\-A\-L}~P\-I\-N0\-\_\-bm}\label{meter_8h_a0db728a697b0c3fe6a12ec0f01c56320}

\item 
\hypertarget{meter_8h_a860f42298602a26bb3e5869ab4a92d8a}{\#define {\bfseries T\-A\-M\-P\-E\-R\-\_\-\-E\-A\-R\-T\-H\-\_\-\-F\-A\-U\-L\-T}~P\-I\-N1\-\_\-bm}\label{meter_8h_a860f42298602a26bb3e5869ab4a92d8a}

\item 
\hypertarget{meter_8h_a4ca488f39dca34314574911cb13cde09}{\#define {\bfseries T\-A\-M\-P\-E\-R\-\_\-\-N\-E\-U\-T\-R\-A\-L\-\_\-\-C\-U\-T}~P\-I\-N3\-\_\-bm}\label{meter_8h_a4ca488f39dca34314574911cb13cde09}

\item 
\hypertarget{meter_8h_a43bafb28b29491ec7f871319b5a3b2f8}{\#define {\bfseries F\-\_\-\-C\-P\-U}~32000000\-U\-L}\label{meter_8h_a43bafb28b29491ec7f871319b5a3b2f8}

\item 
\hypertarget{meter_8h_aca12ec03d86eb5ef061e7a94b02b0ac0}{\#define {\bfseries F\-\_\-\-T\-I\-M\-E\-R}~500000\-U\-L}\label{meter_8h_aca12ec03d86eb5ef061e7a94b02b0ac0}

\item 
\hypertarget{meter_8h_a82c667e21a5795aa646df86ff14431fa}{\#define {\bfseries F\-\_\-\-S\-A\-M\-P\-L\-I\-N\-G}~124}\label{meter_8h_a82c667e21a5795aa646df86ff14431fa}

\item 
\hypertarget{meter_8h_a38c301e2f57b8800c8ac8c9acf66927c}{\#define {\bfseries P\-O\-W\-E\-R\-E\-D\-\_\-\-U\-P}~0}\label{meter_8h_a38c301e2f57b8800c8ac8c9acf66927c}

\item 
\hypertarget{meter_8h_a7eea8bdbb07a7ed4f16b145ffb077551}{\#define {\bfseries P\-O\-W\-E\-R\-\_\-\-O\-F\-F\-\_\-\-D\-E\-T\-E\-C\-T\-E\-D}~1}\label{meter_8h_a7eea8bdbb07a7ed4f16b145ffb077551}

\item 
\hypertarget{meter_8h_ae8131694b06a62416e7b799b129de381}{\#define {\bfseries P\-O\-W\-E\-R\-\_\-\-O\-F\-F}~2}\label{meter_8h_ae8131694b06a62416e7b799b129de381}

\item 
\hypertarget{meter_8h_a7742a2e3c81de16dd55182b04daf453f}{\#define {\bfseries P\-O\-W\-E\-R\-\_\-\-O\-N\-\_\-\-D\-E\-T\-E\-C\-T\-E\-D}~2}\label{meter_8h_a7742a2e3c81de16dd55182b04daf453f}

\item 
\hypertarget{meter_8h_ab45b2bc4583f3a0528cc70aeb1ae4a64}{\#define {\bfseries eeprom}~eeprom\-\_\-t}\label{meter_8h_ab45b2bc4583f3a0528cc70aeb1ae4a64}

\item 
\hypertarget{meter_8h_a4acc179ab572ac28a25bce62e686976b}{\#define {\bfseries meter}~meter\-\_\-t}\label{meter_8h_a4acc179ab572ac28a25bce62e686976b}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{meter_8h_a51f29d3417ada33c90f1ebaabad23d36}{tamper\-\_\-check} (void)
\item 
\hypertarget{meter_8h_aeadc2cfdb5c65bf2ed7315645a0b8607}{int16\-\_\-t {\bfseries adc\-\_\-iadc\-\_\-debug} (void)}\label{meter_8h_aeadc2cfdb5c65bf2ed7315645a0b8607}

\item 
\hypertarget{meter_8h_af7b6c57ac314d52b50a26a1346d36c34}{int16\-\_\-t {\bfseries adc\-\_\-vadc\-\_\-debug} (void)}\label{meter_8h_af7b6c57ac314d52b50a26a1346d36c34}

\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{meter_8h_afd360fb9947d32b0ac9aebc77c04d355}{uint8\-\_\-t {\bfseries rtc\-\_\-flag}}\label{meter_8h_afd360fb9947d32b0ac9aebc77c04d355}

\item 
\hypertarget{meter_8h_a06eafd0ca356b436dd14f8922d71d55b}{uint8\-\_\-t {\bfseries cover\-\_\-open\-\_\-flag}}\label{meter_8h_a06eafd0ca356b436dd14f8922d71d55b}

\item 
\hypertarget{meter_8h_a6148b70d5aa88d6f47b7ff1a479f0ef7}{\-\_\-\-\_\-eeprom struct \hyperlink{structcoefficient}{coefficient} {\bfseries eeprom\-\_\-t}}\label{meter_8h_a6148b70d5aa88d6f47b7ff1a479f0ef7}

\item 
\hypertarget{meter_8h_ab8ce2814e2c1afeb3e21b44ba9af0a4a}{struct \hyperlink{structcoefficient}{coefficient} {\bfseries meter\-\_\-t}}\label{meter_8h_ab8ce2814e2c1afeb3e21b44ba9af0a4a}

\item 
\hypertarget{meter_8h_a88b579aec51c4d8387dce0526846857f}{int16\-\_\-t {\bfseries debug\-\_\-count}}\label{meter_8h_a88b579aec51c4d8387dce0526846857f}

\item 
\hypertarget{meter_8h_a3c3f848e46f400cadc6fb3d9ff8ebbd3}{int16\-\_\-t {\bfseries debug\-\_\-count1}}\label{meter_8h_a3c3f848e46f400cadc6fb3d9ff8ebbd3}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Meter Calibration routine. \begin{DoxyParagraph}{Application note\-:}
A\-V\-R1631\-: Energy Meter Reference Design with A\-Txmega32\-A4
\end{DoxyParagraph}
\begin{DoxyParagraph}{Documentation}
For comprehensive code documentation, supported compilers, compiler settings and supported devices see readme.\-html
\end{DoxyParagraph}
\begin{DoxyAuthor}{Author}
Atmel Corporation\-: \href{http://www.atmel.com}{\tt http\-://www.\-atmel.\-com} \par
 Support email\-: \href{mailto:avr@atmel.com}{\tt avr@atmel.\-com}
\end{DoxyAuthor}
\$\-Revision\-: 1.\-0 \par
 \$\-Date\-: 2012-\/07-\/01 10\-:10\-:10 +0530 \par


Copyright (c) 2008, Atmel Corporation All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met\-:


\begin{DoxyEnumerate}
\item Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
\end{DoxyEnumerate}


\begin{DoxyEnumerate}
\item Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
\end{DoxyEnumerate}


\begin{DoxyEnumerate}
\item The name of A\-T\-M\-E\-L may not be used to endorse or promote products derived from this software without specific prior written permission.
\end{DoxyEnumerate}

T\-H\-I\-S S\-O\-F\-T\-W\-A\-R\-E I\-S P\-R\-O\-V\-I\-D\-E\-D B\-Y A\-T\-M\-E\-L \char`\"{}\-A\-S I\-S\char`\"{} A\-N\-D A\-N\-Y E\-X\-P\-R\-E\-S\-S O\-R I\-M\-P\-L\-I\-E\-D W\-A\-R\-R\-A\-N\-T\-I\-E\-S, I\-N\-C\-L\-U\-D\-I\-N\-G, B\-U\-T N\-O\-T L\-I\-M\-I\-T\-E\-D T\-O, T\-H\-E I\-M\-P\-L\-I\-E\-D W\-A\-R\-R\-A\-N\-T\-I\-E\-S O\-F M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y A\-N\-D F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E A\-R\-E E\-X\-P\-R\-E\-S\-S\-L\-Y A\-N\-D S\-P\-E\-C\-I\-F\-I\-C\-A\-L\-L\-Y D\-I\-S\-C\-L\-A\-I\-M\-E\-D. I\-N N\-O E\-V\-E\-N\-T S\-H\-A\-L\-L A\-T\-M\-E\-L B\-E L\-I\-A\-B\-L\-E F\-O\-R A\-N\-Y D\-I\-R\-E\-C\-T, I\-N\-D\-I\-R\-E\-C\-T, I\-N\-C\-I\-D\-E\-N\-T\-A\-L, S\-P\-E\-C\-I\-A\-L, E\-X\-E\-M\-P\-L\-A\-R\-Y, O\-R C\-O\-N\-S\-E\-Q\-U\-E\-N\-T\-I\-A\-L D\-A\-M\-A\-G\-E\-S (I\-N\-C\-L\-U\-D\-I\-N\-G, B\-U\-T N\-O\-T L\-I\-M\-I\-T\-E\-D T\-O, P\-R\-O\-C\-U\-R\-E\-M\-E\-N\-T O\-F S\-U\-B\-S\-T\-I\-T\-U\-T\-E G\-O\-O\-D\-S O\-R S\-E\-R\-V\-I\-C\-E\-S; L\-O\-S\-S O\-F U\-S\-E, D\-A\-T\-A, O\-R P\-R\-O\-F\-I\-T\-S; O\-R B\-U\-S\-I\-N\-E\-S\-S I\-N\-T\-E\-R\-R\-U\-P\-T\-I\-O\-N) H\-O\-W\-E\-V\-E\-R C\-A\-U\-S\-E\-D A\-N\-D O\-N A\-N\-Y T\-H\-E\-O\-R\-Y O\-F L\-I\-A\-B\-I\-L\-I\-T\-Y, W\-H\-E\-T\-H\-E\-R I\-N C\-O\-N\-T\-R\-A\-C\-T, S\-T\-R\-I\-C\-T L\-I\-A\-B\-I\-L\-I\-T\-Y, O\-R T\-O\-R\-T (I\-N\-C\-L\-U\-D\-I\-N\-G N\-E\-G\-L\-I\-G\-E\-N\-C\-E O\-R O\-T\-H\-E\-R\-W\-I\-S\-E) A\-R\-I\-S\-I\-N\-G I\-N A\-N\-Y W\-A\-Y O\-U\-T O\-F T\-H\-E U\-S\-E O\-F T\-H\-I\-S S\-O\-F\-T\-W\-A\-R\-E, E\-V\-E\-N I\-F A\-D\-V\-I\-S\-E\-D O\-F T\-H\-E P\-O\-S\-S\-I\-B\-I\-L\-I\-T\-Y O\-F S\-U\-C\-H D\-A\-M\-A\-G\-E. 

Definition in file \hyperlink{meter_8h_source}{meter.\-h}.



\subsection{Function Documentation}
\hypertarget{meter_8h_a51f29d3417ada33c90f1ebaabad23d36}{\index{meter.\-h@{meter.\-h}!tamper\-\_\-check@{tamper\-\_\-check}}
\index{tamper\-\_\-check@{tamper\-\_\-check}!meter.h@{meter.\-h}}
\subsubsection[{tamper\-\_\-check}]{\setlength{\rightskip}{0pt plus 5cm}void tamper\-\_\-check (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{meter_8h_a51f29d3417ada33c90f1ebaabad23d36}
This function checks for different types of tampering such as earth fault current reversal, neutral cut, magnetic tampering check for earth fault tamper (Load earthing) \par
 compare the phase current is within 12\% of the neutral current

if tampering persist for 15 secs update the led status

check the status for Current Reversal tampering

if tampering detected toggle the T\-A\-M\-P\-E\-R\-\_\-\-C\-U\-R\-R\-E\-N\-T\-\_\-\-R\-E\-V\-E\-R\-S\-A\-L L\-E\-D

check the status for Neutral C\-U\-T tampering and configure the status led

check the status of Magnetic tamper flag and update the L\-E\-D 

Definition at line 58 of file meter\-\_\-task.\-c.

